# Requires tmux>=2.4
# Not tested on Mac, BSD

################################
# Options
###############################

# Changing ctrl b to ctrl a as the prefix
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# Switch to previous window
bind a last-window

# Automatically set window titles
set-window-option -g automatic-rename on
set -g set-titles on

# Set escape time delay to be smaller
# to make tmux more responsive to commands
set -s escape-time 1
# Address vim mode-switching delay
#set -s escape-time 0

# scrollback size
set -g history-limit 1000

# pass through xterm keys
set -g xterm-keys on

# Force UTF
setw -gq utf on

# Set first window to index 1 (not 0) to map more to the keyboard layout
set -g base-index 1
set -g pane-base-index 1

# tmux messages are displayed for 4 seconds
set -g display-time 4000

# Support for 256 colors in terminal
set -g default-terminal "screen-256color"

# Super useful when using "grouped sessions" and multi-monitor setup
setw -g aggressive-resize on

# Enable mouse support
set -g mouse on

################################
# Keybinds
###############################

# Detach current session
bind-key C-d detach-client

# Redraw the client (if interrupted by wall, etc)
bind R refresh-client
 
# r - reload tmux config
unbind r
bind r source-file ~/.tmux.conf \; display 'Reloaded tmux config.'

# o - rename window
bind-key -T prefix o command-prompt -I "#W" "rename-window -- '%%'"

# t - new window
unbind t
unbind C-t
bind-key t new-window
bind-key C-t new-window


# q - kill session
unbind q
unbind C-q
bind-key q kill-session
bind-key C-q kill-session

# n - New session
unbind n
unbind C-n
bind-key n new-session
bind-key C-n new-session

# Switch between next/prev window
#bind -n C-p previous-window
#bind -n C-n next-window

# ctrl + '+' - Zoom in
unbind C-+
bind C-+ \
new-window -d -n tmux-zoom 'clear && echo TMUX ZOOM && read'\;\
swap-pane -s tmux-zoom.0 \;\
select-window -t tmux-zoom

# ctrl + '-' - Zoom out
unbind C--
bind C-- \
	last-window \;\
	swap-pane -s tmux-zoom.0 \;\
	kill-window -t tmux-zoom

# Visual Activity Monitoring between windows
setw -g monitor-activity on
set -g visual-activity on

################################
# Pane navigation/management
###############################

# Split panes using | and -
bind \ split-window -h -c '#{pane_current_path}'
bind - split-window -v -c '#{pane_current_path}'
unbind '"'
unbind %

# Open new panes in current path
bind c new-window -c '#{pane_current_path}'

# w - kill pane
bind-key w kill-pane

# Enable names for panes
#set -g pane-border-status top

# Use Alt-hjkl keys WITHOUT PREFIX KEY to switch panes
bind -n M-h select-pane -L
bind -n M-l select-pane -R
bind -n M-k select-pane -U
bind -n M-j select-pane -D

# Resizing panes(can also be done with mouse)
bind -r j resize-pane -D 2
bind -r k resize-pane -U 2
bind -r h resize-pane -L 2
bind -r l resize-pane -R 2

# Copy/paste in pane
set-window-option -g mode-keys vi
# Can use visual-mode style selection

# Prefix [ to enter copy mode
# 'Enter' to exit copy mode
bind-key -T copy-mode-vi 'v' send-keys -X begin-selection
bind-key -T copy-mode-vi 'y' send-keys -X copy-selection
bind C-v paste-buffer

# Copy from tmux to system clipboard
# Needs xclip
#bind -t vi-copy y copy-pipe "xclip -sel clip -i"

################################
# Status line
###############################

# Disable all visual bells
#set -g visual-activity off
set -g visual-bell off
set -g visual-silence off
#setw -g monitor-activity off
set -g bell-action none

# enable activity alerts
setw -g monitor-activity on
set -g visual-activity on

# Status position
set -g status-position bottom

# Status line left side
# Session: 0 1 1 settings
set -g status-left-length 20
set -g status-left ''
#set -g status-left "#[fg=colour245]Session: #S #[fg=colour84]#I #[fg=colour75]#P"
set -g status-right '#[fg=colour233,bg=colour3] %d/%m #[fg=colour233,bg=colour8] %H:%M:%S '

#setw -g window-status-current-style 'fg=colour15 bg=colour22 bold'
#setw -g window-status-current-format ' #I#[fg=colour249]:#[fg=colour255]#W#[fg=colour249]#F '
#setw -g window-status-style 'fg=colour9 bg=colour34'
#setw -g window-status-format ' #I#[fg=colour237]:#[fg=colour250]#W#[fg=colour244]#F '

#Window/pane type in centre
set -g status-justify left
#set -g status-justify centre

#Time and date on right-hand side
set -g status-right-length 50
set -g status-right "#[fg=colour245]%d %b #[fg=colour236] %R"

# Update the status bar every sixty seconds (for time)
set -g status-interval 60

################################
# Colors
###############################

# Background of status line
set -g status-bg black
set -g status-style 'bg=colour14 fg=colour137 dim'

setw -g window-status-bell-style 'fg=colour255 bg=colour1 bold'

# set the color of the window list (name of the pane)
setw -g window-status-fg colour3
setw -g window-status-bg default
setw -g window-status-attr dim

#  modes
setw -g clock-mode-colour colour14
setw -g mode-style 'fg=colour3 bg=colour15 bold'

# messages
set -g message-style 'fg=colour232 bg=colour16 bold'

#Show reloaded message in bright white
set -g message-fg white
set -g message-bg default
set -g message-attr bright

# Set inactive/active window styles
#set -g window-style 'fg=colour243,bg=black'
#set -g window-active-style 'fg=colour250,bg=black'

# Pane border
#set -g pane-border-bg colour237
set -g pane-border-fg colour238
#set -g pane-active-border-bg colour239
set -g pane-active-border-fg colour137

# To apply inactive color to vim panes,
# ensure that 'hi Normal' line in colorscheme.vim
# does not contain 'guibg=' and 'ctermbg=' options

################################
# tmux variables
###############################

# $(echo $USER) - shows the current username
# %a --> Day of week (Mon)
# %A --> Day of week Expanded (Monday)

# %b --> Month (Jan)
# %d --> Day (31)
# %Y --> Year (2017)

# %D --> Month/Day/Year (12/31/2017)
# %v --> Day-Month-Year (31-Dec-2017)

# %r --> Hour:Min:Sec AM/PM (12:30:27 PM)
# %T --> 24 Hour:Min:Sec (16:30:27)
# %X --> Hour:Min:Sec (12:30:27)
# %R --> 24 Hour:Min (16:30)
# %H --> 24 Hour (16)
# %l --> Hour (12)
# %M --> Mins (30)
# %S --> Seconds (09)
# %p --> AM/PM (AM)

# For a more complete list view: https://linux.die.net/man/3/strftime

# Run as bash script to see all possible colors
#for i in {0..255} ; do
#    printf "\x1b[38;5;${i}mcolours${i}\n"
#done

#D ()
#F ()
#H (hostname)
#I (window index)
#P ()
#S (session index)
#T (pane title)
#W (currnet task like vim if editing a file in vim or zsh if running zsh)
